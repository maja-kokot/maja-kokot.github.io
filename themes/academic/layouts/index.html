{{ define "main" }}
    <!-- The Re-unified "About Me" Section -->
    <section id="about" class="about-section">
        <div class="about-container">
            <!-- Left Column: Avatar, Name, Links -->
            <div class="about-avatar">
                <img src="{{ .Params.avatar | relURL }}" alt="Avatar" class="avatar-image">
                <h1 class="avatar-name">{{ .Params.name }}</h1>
                <div class="personal-links">
                    {{ range .Params.contact_links }}
                    <a href="{{ .url }}">
                        <i class="{{ .icon }}"></i> {{ .name }}
                    </a>
                    {{ end }}
                </div>
                <div class="social-links">
                     {{ range .Params.social }}
                     <a href="{{ .url }}" title="{{ .name }}" target="_blank">
                         <i class="fab fa-{{ lower .name }}"></i>
                     </a>
                     {{ end }}
                </div>
            </div>
            <!-- Right Column: Bio and Education -->
            <div class="about-bio">
                <h2>About Me</h2>
                {{ .Content }}
                {{ with .Params.education }}
                <div id="education"> 
                    <h3>Education</h3>
                    <ul class="education-list">
                        {{ range .courses }}
                        <li>
                            <i class="fas fa-graduation-cap"></i>
                            <div class="course-details">
                                <div class="course-title">{{ .course }}</div>
                                <div class="course-institution">{{ .institution }}, {{ .year }}</div>
                            </div>
                        </li>
                        {{ end }}
                    </ul>
                </div>
                {{ end }}
            </div>
        </div>
    </section>

    <section id="interactive-graph-container">
        <!-- <h2 class="graph-intro-title">Academic graph</h2> -->
    <p class="graph-intro-text">This is a physics-based visualization of my academic interests. Click on a node to learn more, or drag them around to explore the connections.</p>

        <!-- The p5.js canvas will be created inside this div -->
        <div id="canvas-holder"></div>
    </section>

    <section id="timeline-preview" class="fade-in-section">
        <!-- <h2>Timeline</h2> -->
        
        <!-- This new wrapper will hold the dashed line -->
        <div class="timeline-snippet-wrapper">
            
            {{/* Loop through the 3 most recent events */}}
            {{ range first 3 (where .Site.RegularPages "Section" "timeline").ByDate.Reverse }}
            <div class="timeline-item" data-title="{{ .Title }}" data-date="{{ .Date.Format "January 2, 2006" }}">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                    <h5 class="timeline-title">{{ .Title }}</h5>
                </div>
                <div class="timeline-description-hidden" style="display: none;">
                    {{ .Content }}
                </div>
            </div>
            {{ end }}

            <!-- Treat the button as the final timeline item -->
            <div class="timeline-item is-button-item">
                <div class="timeline-dot"></div>
                <div class="timeline-button-container">
                    <a href="/timeline/" class="timeline-view-all-button">View Entire Timeline</a>
                </div>
            </div>

        </div>
    </section>

    <!-- The rest of the sections follow as before -->
    {{ with .Site.GetPage "/writing.md" }}
    <section id="writing" class="fade-in-section">
        <h2>{{ .Title }}</h2>
        <div class="content-container">{{ .Content }}</div>
    </section>
    {{ end }}

    <section id="notes" class="fade-in-section">
    <h2>Lecture Notes</h2>
    <p>A collection of my academic and personal study notes. Each note is available for download as a high-quality PDF.</p>
    
    <div class="search-container">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="Search definitions...">
                    <div id="search-results"></div>
                </div>
    
    <div class="notes-grid">
        {{/* This finds all pages inside the "content/notes" folder */}}
        {{ range .Site.Sections.ByTitle }}
            {{ if eq .Section "notes" }}
                {{ range .Pages.ByTitle }}
                <div class="note-card">
                    <h3>{{ .Title }}</h3>
                    <p>{{ .Params.summary }}</p>
                    <div class="note-card-links">
                        <a href="{{ .Params.pdf_url }}" class="button-view-notes" target="_blank">
                            <i class="fas fa-file-pdf"></i> View PDF
                        </a>
                    </div>
                </div>
                {{ end }}
            {{ end }}
        {{ end }}
    </div>
</section>

    {{ with .Site.GetPage "/olympiad.md" }}
    <section id="olympiad" class="fade-in-section">
        <h2>{{ .Title }}</h2>
        <div class="content-container">{{ .Content }}</div>
    </section>
    {{ end }}

    {{ with .Site.GetPage "/projects.md" }}
    <section id="projects" class="fade-in-section">
        <h2>{{ .Title }}</h2>
        <div class="content-container">{{ .Content }}</div>
    </section>
    {{ end }}
{{ end }}